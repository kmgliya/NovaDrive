# NovaDrive — Премиальная платформа бронирования (Frontend)

NovaDrive — фронтенд на Next.js (App Router) для премиального сервиса бронирования, вдохновленного SIXT.
Сделано по **Тестовому заданию №2 (Frontend: Dashboard + бизнес‑логика)** с FSD‑архитектурой, сложной логикой слотов,
оптимистичными обновлениями и реалистичным админ‑UX.

## Что это за проект

Полный фронтенд для онлайн‑бронирования услуг:
- многошаговый мастер бронирования,
- генерация слотов с буферами и конфликтами,
- блокировки слотов по таймеру,
- личный кабинет пользователя (перенос/отмена),
- админ‑панель (автопарк + мастера),
- RU/EN локализация,
- страница «О нас» с видео и Google Maps.

## Стек

- **Next.js 16 (App Router)** + TypeScript
- **Tailwind CSS** + `clsx`/`tailwind-merge`
- **React Query** для серверного состояния
- **Zustand** для UI/навигационного состояния (wizard, locks, auth)
- **Axios** с mock‑adapter (задержки, конфликты, частичные ошибки)
- **Recharts** для дашбордов
- **Lucide React** иконки

## Архитектура (FSD)

```
shared/     ui, api, utils, i18n
entities/   service, specialist, schedule, timeSlot, booking, user
features/   create-booking, reschedule-booking, cancel-booking, lock-slot, auth
widgets/    service-selector, specialist-schedule, booking-summary, user-bookings
app/        services, booking, profile, admin, about, catalog
```

Бизнес‑логика (слоты, локи, конфликты) вынесена из UI.

## Ключевая бизнес‑логика

### Генерация слотов
- Формируются по **рабочему времени**, **длительности услуги**, **буферам до/после**.
- Пересечения исключаются.
- На день у мастера генерируется **2–3 реалистичных слота**.

### Блокировка слота (3 минуты)
- При выборе слот блокируется на 3 минуты.
- Если бронь не подтверждена — слот освобождается автоматически.
- Блокировки живут в Zustand + таймеры очистки.

### Мастер бронирования
- 4 шага: услуга → мастер → время → оплата.
- Состояние сохраняется в Zustand (persist) и не сбрасывается при обновлении страницы.

### Перенос / отмена
- Оптимистичное обновление.
- Проверка конфликтов на mock‑API.
- Откат при ошибках.
- Перенос выполняется через выбор **свободного слота** (как при новом бронировании).

## Реализация требований ТЗ

### Модели данных (TypeScript)
- **Service**: id, название, длительность, стоимость, буферы до/после
- **Specialist**: id, имя, специализация, рабочие часы по дням, список услуг, аватар
- **TimeSlot**: id, specialistId, start/end, статус (free/locked/booked)
- **Booking**: id, serviceId, specialistId, timeSlotId, клиент, статус, createdAt
- **User**: id, имя, телефон, роль

### Слоты и доступность
- 2–3 слота в день на одного мастера.
- Учтены буферы и существующие брони.

### Временные блокировки
- Слот блокируется на 3 минуты.
- Авто‑освобождение, если бронирование не завершено.

### Многошаговое бронирование
1) Выбор услуги  
2) Выбор мастера  
3) Выбор даты/времени  
4) Оплата и подтверждение

### Личный кабинет
- Профиль пользователя (имя, телефон, email, статус)
- Активные и прошлые брони
- Перенос и отмена активных

### Админ‑панель
- Дашборд + динамические графики
- Управление автопарком
- Управление мастерами (имя, фото, специализация)
- Защита роли администратора

## Mock API

- Симуляция задержек, конфликтов, частичных ошибок.
- Брони и мастера сохраняются в `localStorage`.

### Эндпоинты
- `GET /services`, `GET /specialists`, `GET /bookings`, `GET /dashboard`
- `POST /slots/lock`, `DELETE /slots/lock`
- `POST /bookings`, `PATCH /bookings/:id` (перенос/отмена)
- `PATCH /specialists/:id` (изменения мастеров)

## Kaggle Dataset (Интеграция)

Датасет: https://www.kaggle.com/datasets/CooperUnion/cardataset  
Файл:
```
public/data/car_dataset.csv
```
Дашборд использует его для расчета:
- **Средней цены MSRP**
- **Количества моделей**
- **Топ‑брендов** (bar chart)

Чтобы подключить полный датасет — просто замените `public/data/car_dataset.csv`.

## Локализация (RU/EN)

Переключатель языка около логотипа.
Все ключевые тексты переведены через `useI18n`.

## Маршруты

- `/` — Главная
- `/services` — Услуги
- `/booking` — Бронирование
- `/profile` — Профиль пользователя
- `/admin` — Админ‑панель (guarded)
- `/about` — О нас (видео + карта)
- `/catalog` — Каталог авто
- `/login` `/register` — Авторизация (mock)

## Доступ администратора

Для регистрации/входа админа введите код:
```
novadrive-admin
```

## Оплата (Mock)

Оплата имитируется:
- Вводятся числовые поля карты
- Подтверждение доступно после заполнения
- Итог отображается в блоке оплаты

## Запуск

```bash
npm install
npm run dev
```

Открыть: http://localhost:3000

## Trade-offs

- Бэкенд заменен mock‑API для имитации конфликтов и задержек.
- Данные хранятся в localStorage для реалистичности.
- Роль администратора задается секретным кодом (без backend‑авторизации).

## Чеклист покрытия ТЗ

- ✅ FSD структура
- ✅ Генерация слотов + конфликты
- ✅ Блокировка слотов + таймер
- ✅ Мастер бронирования с persist
- ✅ Перенос/отмена (оптимистично + rollback)
- ✅ Личный кабинет (active/past)
- ✅ Фоновая синхронизация
- ✅ Моделирование конфликтов и ошибок
- ✅ Строгая типизация
- ✅ Динамический дашборд на датасете

## Для защиты проекта

- Бизнес‑логика вынесена в `entities`/`features`, UI в `widgets`.
- React Query — кеш и синхронизация; Zustand — только UI/flow.
- Kaggle dataset подключен в дашборд для реалистичных метрик.
